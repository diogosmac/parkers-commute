var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},s={},i=e.parcelRequirebdea;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in s){var i=s[e];delete s[e];var o={id:e,exports:{}};return t[e]=o,i.call(o.exports,o,o.exports),o.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){s[e]=t},e.parcelRequirebdea=i),i.register("8vghX",(function(e,t){var s=i("hPtJY"),o=i("kjyEk"),a=i("59kwG"),n=i("ccDAZ");const r=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function l(e){console.log(`[dotenv][DEBUG] ${e}`)}const E={config:function(e){let t=a.resolve(s.cwd(),".env"),i="utf8";const r=Boolean(e&&e.debug),d=Boolean(e&&e.override);var u;e&&(null!=e.path&&(t="~"===(u=e.path)[0]?a.join(n.homedir(),u.slice(1)):u),null!=e.encoding&&(i=e.encoding));try{const e=E.parse(o.readFileSync(t,{encoding:i}));return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(s.env,t)?(!0===d&&e[t],r&&l(!0===d?`"${t}" is already defined in \`process.env\` and WAS overwritten`:`"${t}" is already defined in \`process.env\` and was NOT overwritten`)):e[t]})),{parsed:e}}catch(e){return r&&l(`Failed to load ${t} ${e.message}`),{error:e}}},parse:function(e){const t={};let s,i=e.toString();for(i=i.replace(/\r\n?/gm,"\n");null!=(s=r.exec(i));){const e=s[1];let i=s[2]||"";i=i.trim();const o=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===o&&(i=i.replace(/\\n/g,"\n"),i=i.replace(/\\r/g,"\r")),t[e]=i}return t}};e.exports.config=E.config,e.exports.parse=E.parse,e.exports=E})),i.register("kjyEk",(function(e,t){})),i.register("59kwG",(function(e,t){var s=i("hPtJY");function o(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function a(e,t){for(var s,i="",o=0,a=-1,n=0,r=0;r<=e.length;++r){if(r<e.length)s=e.charCodeAt(r);else{if(47===s)break;s=47}if(47===s){if(a===r-1||1===n);else if(a!==r-1&&2===n){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var l=i.lastIndexOf("/");if(l!==i.length-1){-1===l?(i="",o=0):o=(i=i.slice(0,l)).length-1-i.lastIndexOf("/"),a=r,n=0;continue}}else if(2===i.length||1===i.length){i="",o=0,a=r,n=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(a+1,r):i=e.slice(a+1,r),o=r-a-1;a=r,n=0}else 46===s&&-1!==n?++n:n=-1}return i}var n={resolve:function(){for(var e,t="",i=!1,n=arguments.length-1;n>=-1&&!i;n--){var r;n>=0?r=arguments[n]:(void 0===e&&(e=s.cwd()),r=e),o(r),0!==r.length&&(t=r+"/"+t,i=47===r.charCodeAt(0))}return t=a(t,!i),i?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(o(e),0===e.length)return".";var t=47===e.charCodeAt(0),s=47===e.charCodeAt(e.length-1);return 0!==(e=a(e,!t)).length||t||(e="."),e.length>0&&s&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return o(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var s=arguments[t];o(s),s.length>0&&(void 0===e?e=s:e+="/"+s)}return void 0===e?".":n.normalize(e)},relative:function(e,t){if(o(e),o(t),e===t)return"";if((e=n.resolve(e))===(t=n.resolve(t)))return"";for(var s=1;s<e.length&&47===e.charCodeAt(s);++s);for(var i=e.length,a=i-s,r=1;r<t.length&&47===t.charCodeAt(r);++r);for(var l=t.length-r,E=a<l?a:l,d=-1,u=0;u<=E;++u){if(u===E){if(l>E){if(47===t.charCodeAt(r+u))return t.slice(r+u+1);if(0===u)return t.slice(r+u)}else a>E&&(47===e.charCodeAt(s+u)?d=u:0===u&&(d=0));break}var p=e.charCodeAt(s+u);if(p!==t.charCodeAt(r+u))break;47===p&&(d=u)}var c="";for(u=s+d+1;u<=i;++u)u!==i&&47!==e.charCodeAt(u)||(0===c.length?c+="..":c+="/..");return c.length>0?c+t.slice(r+d):(r+=d,47===t.charCodeAt(r)&&++r,t.slice(r))},_makeLong:function(e){return e},dirname:function(e){if(o(e),0===e.length)return".";for(var t=e.charCodeAt(0),s=47===t,i=-1,a=!0,n=e.length-1;n>=1;--n)if(47===(t=e.charCodeAt(n))){if(!a){i=n;break}}else a=!1;return-1===i?s?"/":".":s&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');o(e);var s,i=0,a=-1,n=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var r=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var E=e.charCodeAt(s);if(47===E){if(!n){i=s+1;break}}else-1===l&&(n=!1,l=s+1),r>=0&&(E===t.charCodeAt(r)?-1==--r&&(a=s):(r=-1,a=l))}return i===a?a=l:-1===a&&(a=e.length),e.slice(i,a)}for(s=e.length-1;s>=0;--s)if(47===e.charCodeAt(s)){if(!n){i=s+1;break}}else-1===a&&(n=!1,a=s+1);return-1===a?"":e.slice(i,a)},extname:function(e){o(e);for(var t=-1,s=0,i=-1,a=!0,n=0,r=e.length-1;r>=0;--r){var l=e.charCodeAt(r);if(47!==l)-1===i&&(a=!1,i=r+1),46===l?-1===t?t=r:1!==n&&(n=1):-1!==t&&(n=-1);else if(!a){s=r+1;break}}return-1===t||-1===i||0===n||1===n&&t===i-1&&t===s+1?"":e.slice(t,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var s=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return s?s===t.root?s+i:s+e+i:i}("/",e)},parse:function(e){o(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var s,i=e.charCodeAt(0),a=47===i;a?(t.root="/",s=1):s=0;for(var n=-1,r=0,l=-1,E=!0,d=e.length-1,u=0;d>=s;--d)if(47!==(i=e.charCodeAt(d)))-1===l&&(E=!1,l=d+1),46===i?-1===n?n=d:1!==u&&(u=1):-1!==n&&(u=-1);else if(!E){r=d+1;break}return-1===n||-1===l||0===u||1===u&&n===l-1&&n===r+1?-1!==l&&(t.base=t.name=0===r&&a?e.slice(1,l):e.slice(r,l)):(0===r&&a?(t.name=e.slice(1,n),t.base=e.slice(1,l)):(t.name=e.slice(r,n),t.base=e.slice(r,l)),t.ext=e.slice(n,l)),r>0?t.dir=e.slice(0,r-1):a&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};n.posix=n,e.exports=n})),i.register("ccDAZ",(function(e,t){var s,i,o,a,n;s=e.exports,i="homedir",o=()=>n,a=e=>n=e,Object.defineProperty(s,i,{get:o,set:a,enumerable:!0,configurable:!0}),n=function(){return"/"}}));const o={SCENES:{LOAD:"LOAD",MENU:"MENU",LEVEL:"LEVEL",DEFER:"DEFER",CREDITS:"CREDITS",MODAL:"MODAL",MODAL_T:"MODAL_TRANSITION",MULTIMODAL:"MULTIMODAL",MODAL_EOL:"MODAL_END_OF_LEVEL",MODAL_GAMEOVER:"MODAL_GAMEOVER"},STYLES:{BATTERY_PERCENTAGE:{font:"500 16px Roboto",fill:"#fff"},DEST_USES:{font:"500 16px Roboto",fill:"#fff"},FLAVOR_SMALL:{font:"500 18px Roboto",fill:"#fff"},FLAVOR_LARGE:{font:"500 32px Roboto",fill:"#fff"},END_OF_LEVEL:{font:"500 24px Roboto",fill:"#202020"}},DEST:{HOME:"level_dest_home",HOME_OUT:"level_dest_home_out",WORK:"level_dest_work",WORK_OUT:"level_dest_work_out",SUPERMARKET:"level_dest_supermarket",SUPERMARKET_OUT:"level_dest_supermarket_out",GYM:"level_dest_gym",GYM_OUT:"level_dest_gym_out",SELECTED:"level_dest_selected"},LEVEL:{BACKGROUND:"level_bg",BATTERY:{FULL:"level_battery_full_bar",USABLE:"level_battery_usable_bar",USED:"level_battery_used_bar"},ROUTE:{OPEN:"level_route_open",CLOSED:"level_route_closed",BAR_EMPTY:"level_route_bar_empty",BAR_FULL:"level_route_bar_full",HOME:"level_route_home",WORK:"level_route_work",SUPERMARKET:"level_route_supermarket",GYM:"level_route_gym"},GO:{UNUSABLE:"level_go_unusable",USABLE:"level_go_button"},LOAD:"level_load_overlay",POWERUPS:{BAR:"level_powerups_bar",HOT:"level_powerups_hot",HEAT:"level_powerups_heat",COLD:"level_powerups_cold",COOL:"level_powerups_cool",DOUBLETIME:"level_powerups_doubletime",POWERDOWN:"level_powerups_powerdown",SELECTED:"level_powerups_selected",DISABLED:"level_powerups_disabled"}},ICONS:{TEMPERATURE:"level_temperature",HUMIDITY:"level_humidity",BATTERY:"level_battery"},PLACEHOLDER:{MAP:"level_map",POWERUPS:"level_powerups"},TITLE:{BACKGROUND:"title_bg",PLAY:"title_play_button",OPTIONS:"title_options_button",CREDITS:"title_credits_button",MINI:"title_mini"},CREDITS:{TEXT:"credits_text",BUTTON:"credits_button"},MOUSE:{CLICK_RELEASE:"pointerup",CLICK:"pointerdown",HOVER:"pointerover",LEAVE:"pointerout"},WEATHER:{REGULAR:{ICON:"weather_regular",HUMIDITY:35,TEMP:20},CHILL:{ICON:"weather_chill",HUMIDITY:70,TEMP:9},COLD:{ICON:"weather_cold",HUMIDITY:85,TEMP:-6},HOT:{ICON:"weather_hot",HUMIDITY:0,TEMP:35},WARM:{ICON:"weather_warm",HUMIDITY:10,TEMP:29}},ANIM:{DURATION:1e3},MODALS:{BG:"modals_bg",INTRO:"modals_intro",TUTORIAL_1:"modals_tutorial_1",TUTORIAL_2:"modals_tutorial_2",TUTORIAL_3:"modals_tutorial_3",POWERUPS_1:"modals_powerups_1",POWERUPS_2:"modals_powerups_2",POWERUPS_3:"modals_powerups_3",NOMOREHELP:"modals_nomorehelp",EOL:"modals_end-of-level",GAMEOVER_1:"modals_end-of-game_1",GAMEOVER_2:"modals_end-of-game_2",LEVEL_FAILED:"modals_level-failed",WAIT_LOAD:"modals_wait-load",NAV_L:"modals_nav_l",NAV_R:"modals_nav_r",BTN_INTRO:"modals_btn_letsgo",BTN_TUTORIAL:"modals_btn_gotit",BTN_POWERUPS:"modals_btn_imready",BTN_NOMOREHELP:"modals_btn_nomorehelp",BTN_EOL_BACK:"modals_btn_eol_back",BTN_EOL_ADVANCE:"modals_btn_eol_advance",BTN_MAINMENU:"modals_btn_mainmenu",BTN_TRYAGAIN:"modals_btn_tryagain",BTN_FINE:"modals_btn_fine"},CALC:{BASE:376.59,PREDICTED_DIST_TO_EMISSIONS:122.3,PREDICTED_DIST_TO_FUEL:.07,PREDICTED_FUEL_TO_MONEY:1.78,MARGIN:.01},POS:{WEATHER:{ICON:[53,24],HUMIDITY:{ICON:[177,64],TEXT:[153.5,76.5]},TEMPERATURE:{ICON:[177,29],TEXT:[153.5,41.5]}},BATTERY:{ICON:[53,496],TEXT:[138.775,532],BAR:[192,513],PERCENTAGE:[720.62,531.5]},MAP:[142,127],POWERUPS:{BAR:[52,127],X:62.4,Y:137.4,DELTA:62.4},ROUTE:{BAR:[53,437],SLOT:[53,409],SLOT_GAP:90},GO:[593,48]}};class a extends Phaser.Scene{constructor(){super({key:o.SCENES.CREDITS})}preload(){}create(){this.add.image(0,0,o.TITLE.BACKGROUND).setOrigin(0).setDepth(0),this.add.image(75,41,o.CREDITS.TEXT).setOrigin(0).setDepth(1);const e=this.add.image(686,46,o.CREDITS.BUTTON).setOrigin(0).setDepth(2);e.setInteractive(),e.on(o.MOUSE.CLICK_RELEASE,(()=>{this.scene.stop()}))}}i("8vghX").config({silent:!0});const n={API_KEY:"AIzaSyCTEQhFve9aGKHYlKBBvyO1ZXx5l4fAXEY",API_URL:"https://parkers-commute-api-diogosmac.koyeb.app",ASSETS_URL:"./assets",LOCATIONS:{HOME:localStorage.getItem("home")||"Maia",WORK:localStorage.getItem("work")||"FEUP",SUPERMARKET:localStorage.getItem("market")||"Gaia Shopping",GYM:localStorage.getItem("gym")||"Solinca Ermesinde"}},r={NEXT:1,LEVELS:{1:{DATA:{WEATHER:o.WEATHER.REGULAR},GAMEPLAY:{current_battery:"0%",next_route:1,selected_route:null,destinations:{Home:{icon:o.DEST.HOME,icon_out:o.DEST.HOME_OUT,route:o.LEVEL.ROUTE.HOME,uses:1,screen_position:{x:253,y:23},map_url:n.LOCATIONS.HOME},Supermarket:{icon:o.DEST.SUPERMARKET,icon_out:o.DEST.SUPERMARKET_OUT,route:o.LEVEL.ROUTE.SUPERMARKET,uses:1,screen_position:{x:344.18,y:23},map_url:n.LOCATIONS.SUPERMARKET}},routes:[{name:"Home",icon:o.LEVEL.ROUTE.HOME}]},DESIRED_ROUTES:[["Home","Supermarket","Home"]],script_key:1,script:function(e){p.launchModal(e,{text:[o.MODALS.TUTORIAL_1,o.MODALS.TUTORIAL_2,o.MODALS.TUTORIAL_3],btn:o.MODALS.BTN_TUTORIAL})}},2:{DATA:{WEATHER:o.WEATHER.REGULAR},GAMEPLAY:{current_battery:"0%",next_route:1,selected_route:null,destinations:{Home:{icon:o.DEST.HOME,icon_out:o.DEST.HOME_OUT,route:o.LEVEL.ROUTE.HOME,uses:1,screen_position:{x:253,y:23},map_url:n.LOCATIONS.HOME},Work:{icon:o.DEST.WORK,icon_out:o.DEST.WORK_OUT,route:o.LEVEL.ROUTE.WORK,uses:1,screen_position:{x:344.18,y:23},map_url:n.LOCATIONS.WORK}},routes:[{name:"Home",icon:o.LEVEL.ROUTE.HOME}],powerups:["Hot","Cooling"]},DESIRED_ROUTES:[["Home","Work","Home"]],DESIRED_POWERUPS:["Hot","Cooling"],script_key:2,script:function(e){p.launchModal(e,{text:[o.MODALS.POWERUPS_1,o.MODALS.POWERUPS_2,o.MODALS.POWERUPS_3],btn:o.MODALS.BTN_POWERUPS})}},3:{DATA:{WEATHER:o.WEATHER.REGULAR},GAMEPLAY:{current_battery:"0%",next_route:1,selected_route:null,destinations:{Home:{icon:o.DEST.HOME,icon_out:o.DEST.HOME_OUT,route:o.LEVEL.ROUTE.HOME,uses:1,screen_position:{x:253,y:23},map_url:n.LOCATIONS.HOME},Supermarket:{icon:o.DEST.SUPERMARKET,icon_out:o.DEST.SUPERMARKET_OUT,route:o.LEVEL.ROUTE.SUPERMARKET,uses:1,screen_position:{x:344.18,y:23},map_url:n.LOCATIONS.SUPERMARKET},Gym:{icon:o.DEST.GYM,icon_out:o.DEST.GYM_OUT,route:o.LEVEL.ROUTE.GYM,uses:1,screen_position:{x:435.36,y:23},map_url:n.LOCATIONS.GYM}},routes:[{name:"Home",icon:o.LEVEL.ROUTE.HOME}],powerups:["Hot","Cooling","Cold","Heating"]},DESIRED_ROUTES:[["Home","Supermarket","Gym","Home"],["Home","Gym","Supermarket","Home"]],DESIRED_POWERUPS:["Cold","Heating"],script_key:3,script:function(e){p.launchModal(e,{text:o.MODALS.NOMOREHELP,btn:o.MODALS.BTN_NOMOREHELP})}},4:{DATA:{WEATHER:o.WEATHER.REGULAR},GAMEPLAY:{next_route:1,selected_route:null,destinations:{Home:{icon:o.DEST.HOME,icon_out:o.DEST.HOME_OUT,route:o.LEVEL.ROUTE.HOME,uses:2,screen_position:{x:219,y:23},map_url:n.LOCATIONS.HOME},Work:{icon:o.DEST.WORK,icon_out:o.DEST.WORK_OUT,route:o.LEVEL.ROUTE.WORK,uses:1,screen_position:{x:310.18,y:23},map_url:n.LOCATIONS.WORK},Supermarket:{icon:o.DEST.SUPERMARKET,icon_out:o.DEST.SUPERMARKET_OUT,route:o.LEVEL.ROUTE.SUPERMARKET,uses:1,screen_position:{x:401.36,y:23},map_url:n.LOCATIONS.SUPERMARKET},Gym:{icon:o.DEST.GYM,icon_out:o.DEST.GYM_OUT,route:o.LEVEL.ROUTE.GYM,uses:1,screen_position:{x:492.54,y:23},map_url:n.LOCATIONS.GYM}},routes:[{name:"Home",icon:o.LEVEL.ROUTE.HOME}],powerups:["Hot","Cooling","Double-Time","Power-Down"]},DESIRED_ROUTES:[["Home","Work","Home","Gym","Supermarket","Home"],["Home","Work","Home","Supermarket","Gym","Home"],["Home","Work","Gym","Home","Supermarket","Home"],["Home","Work","Supermarket","Home","Gym","Home"],["Home","Gym","Home","Supermarket","Work","Home"],["Home","Gym","Home","Work","Supermarket","Home"],["Home","Gym","Supermarket","Home","Work","Home"],["Home","Gym","Work","Home","Supermarket","Home"],["Home","Supermarket","Home","Work","Gym","Home"],["Home","Supermarket","Home","Gym","Work","Home"],["Home","Supermarket","Work","Home","Gym","Home"],["Home","Supermarket","Gym","Home","Work","Home"]],DESIRED_POWERUPS:["Hot","Cooling","Double-Time","Power-Down"]}}},l={decreaseBattery(e,t){const s=e.visual.battery_full,i=e.visual.battery_ref;e.GAMEPLAY.AUTONOMY_MULTIPLIER*=t;const o=e.GAMEPLAY.AUTONOMY_MULTIPLIER;i.displayWidth=s.frame.width*e.DATA.max_battery_dec/o;const a=Math.round(+e.DATA.max_battery/o);e.visual.BATTERY.setText(a+"%")},restoreBattery(e,t){const s=e.visual.battery_full,i=e.visual.battery_ref;e.GAMEPLAY.AUTONOMY_MULTIPLIER/=t;const o=e.GAMEPLAY.AUTONOMY_MULTIPLIER;i.displayWidth=s.frame.width*e.DATA.max_battery_dec/o;const a=Math.round(+e.DATA.max_battery/o);e.visual.BATTERY.setText(a+"%")},changeWeather(e,t,s){this.prev_weather={icon:e.visual.weather,data:e.DATA.WEATHER,check:s},this.hasOwnProperty("weather_icon")&&this.weather_icon.destroy(),e.visual.weather.setVisible(!1),this.weather_icon=e.add.image(o.POS.WEATHER.ICON[0],o.POS.WEATHER.ICON[1],t.ICON).setOrigin(0).setDepth(2),e.visual.temperature.setText(t.TEMP+"ºC"),e.visual.humidity.setText(t.HUMIDITY+"%")},restoreWeather(e,t){this.prev_weather.check===t&&(this.weather_icon.destroy(),delete this.weather_icon,this.prev_weather.icon.setVisible(!0),e.visual.temperature.setText(this.prev_weather.data.TEMP+"ºC"),e.visual.humidity.setText(this.prev_weather.data.HUMIDITY+"%"))}},E={Cold:{name:"Cold",description:"The cold temperature has reduced the autonomy of the car.",icon:o.LEVEL.POWERUPS.COLD,visuals:o.WEATHER.COLD,multiplier:1.15,incompatible:["Hot"],apply:function(e){e.GAMEPLAY.DIST_MULTIPLIER*=this.multiplier,l.changeWeather(e,this.visuals,this.name)},unapply:function(e){e.GAMEPLAY.DIST_MULTIPLIER/=this.multiplier,l.restoreWeather(e,this.name)}},Heating:{name:"Heating",description:"Increases battery expenditure in cold temperatures.",icon:o.LEVEL.POWERUPS.HEAT,multiplier:1.5,requires:["Cold"],apply:function(e){e.GAMEPLAY.DIST_MULTIPLIER*=this.multiplier},unapply:function(e){e.GAMEPLAY.DIST_MULTIPLIER/=this.multiplier}},Hot:{name:"Hot",description:"The hot temperature has reduced the autonomy of the car.",icon:o.LEVEL.POWERUPS.HOT,visuals:o.WEATHER.HOT,multiplier:1.05,incompatible:["Cold"],apply:function(e){e.GAMEPLAY.DIST_MULTIPLIER*=this.multiplier,l.changeWeather(e,this.visuals,this.name)},unapply:function(e){e.GAMEPLAY.DIST_MULTIPLIER/=this.multiplier,l.restoreWeather(e,this.name)}},Cooling:{name:"Cooling",icon:o.LEVEL.POWERUPS.COOL,description:"Increases battery expenditure in hot temperatures.",multiplier:1.15,requires:["Hot"],apply:function(e){e.GAMEPLAY.DIST_MULTIPLIER*=this.multiplier},unapply:function(e){e.GAMEPLAY.DIST_MULTIPLIER/=this.multiplier}},"Double-Time":{name:"Double-Time",icon:o.LEVEL.POWERUPS.DOUBLETIME,description:"We're in a rush! Battery expenditure is doubled for this level.",multiplier:1.25,apply:function(e){e.GAMEPLAY.DIST_MULTIPLIER*=this.multiplier},unapply:function(e){e.GAMEPLAY.DIST_MULTIPLIER/=this.multiplier}},"Power-Down":{name:"Power-Down",icon:o.LEVEL.POWERUPS.POWERDOWN,description:"The battery is malfunctioning! Battery autonomy is reduced for this level.",multiplier:2,apply:function(e){l.decreaseBattery(e,this.multiplier)},unapply:function(e){l.restoreBattery(e,this.multiplier)}}},d={copy:e=>JSON.parse(JSON.stringify(e)),arrayRemove(e,t){const s=e.indexOf(t);return s>-1&&(e.splice(s,1),!0)},roundToDecimals(e,t){const s=10**t;return Math.round(e*s)/s},reposition(){const e=document.getElementById("gm-place"),t=document.getElementById("gm-directions"),s=document.getElementById("overlay"),i=document.getElementsByTagName("canvas")[0].getBoundingClientRect();s.style.left=i.left+10+"px",s.style.top=i.top+10+"px";const o=i.left+10+142+"px",a=i.top+10+127+"px";e.style.left=o,e.style.top=a,t.style.left=o,t.style.top=a}},u={INIT:"REQUEST_INIT",CHECK:"REQUEST_CHECK"},p={setupInterface(e){e.add.image(0,0,o.LEVEL.BACKGROUND).setOrigin(0).setDepth(0);const t=e.DATA.WEATHER;e.visual.weather=e.add.image(o.POS.WEATHER.ICON[0],o.POS.WEATHER.ICON[1],t.ICON).setOrigin(0).setDepth(1),e.visual.temperature=e.add.text(o.POS.WEATHER.TEMPERATURE.TEXT[0],o.POS.WEATHER.TEMPERATURE.TEXT[1],t.TEMP+"ºC",o.STYLES.FLAVOR_SMALL).setOrigin(.5),e.add.image(o.POS.WEATHER.TEMPERATURE.ICON[0],o.POS.WEATHER.TEMPERATURE.ICON[1],o.ICONS.TEMPERATURE).setOrigin(0).setDepth(1),e.visual.humidity=e.add.text(o.POS.WEATHER.HUMIDITY.TEXT[0],o.POS.WEATHER.HUMIDITY.TEXT[1],t.HUMIDITY+"%",o.STYLES.FLAVOR_SMALL).setOrigin(.5),e.add.image(o.POS.WEATHER.HUMIDITY.ICON[0],o.POS.WEATHER.HUMIDITY.ICON[1],o.ICONS.HUMIDITY).setOrigin(0).setDepth(1),e.add.image(o.POS.BATTERY.ICON[0],o.POS.BATTERY.ICON[1],o.ICONS.BATTERY).setOrigin(0).setDepth(1),e.visual.BATTERY=e.add.text(o.POS.BATTERY.TEXT[0],o.POS.BATTERY.TEXT[1],e.DATA.max_battery+"%",o.STYLES.FLAVOR_LARGE).setOrigin(.5),e.add.image(o.POS.MAP[0],o.POS.MAP[1],o.PLACEHOLDER.MAP).setOrigin(0).setDepth(1),e.visual.dest_outline=e.add.image(0,18,o.DEST.SELECTED).setOrigin(0).setDepth(1).setVisible(!1)},placeDestinationSquare(e,t){let s=e.GAMEPLAY.destinations[t];s.icon=e.add.image(s.screen_position.x,s.screen_position.y,s.icon).setOrigin(0).setDepth(1),s.icon_out=e.add.image(s.screen_position.x,s.screen_position.y,s.icon_out).setOrigin(0).setDepth(1).setVisible(!1),s.icon.setInteractive(),s.icon.on(o.MOUSE.CLICK_RELEASE,(()=>{t===e.GAMEPLAY.selected_route?(e.GAMEPLAY.selected_route=null,e.visual.dest_outline.setVisible(!1)):s.uses>0&&(e.GAMEPLAY.selected_route=t,e.visual.dest_outline.x=s.screen_position.x,e.visual.dest_outline.setVisible(!0))})),s.text=e.add.text(s.screen_position.x+68.63,s.screen_position.y+13.56,s.uses,o.STYLES.DEST_USES).setOrigin(.5).setDepth(2)},updateDestDisplay(e){e.icon.setVisible(e.uses>0),e.icon_out.setVisible(0===e.uses),e.text.setText(e.uses)},placePowerUps(e){if(!e.GAMEPLAY.hasOwnProperty("powerups"))return void e.add.image(o.POS.POWERUPS.BAR[0],o.POS.POWERUPS.BAR[1],o.PLACEHOLDER.POWERUPS).setOrigin(0).setDepth(1);e.add.image(o.POS.POWERUPS.BAR[0],o.POS.POWERUPS.BAR[1],o.LEVEL.POWERUPS.BAR).setOrigin(0).setDepth(1);let t=0;e.visual.selected_powerups={},e.visual.disabled_powerups={};for(const s of e.GAMEPLAY.powerups.slice(0,4)){const i=E[s],a=o.POS.POWERUPS.X,n=o.POS.POWERUPS.Y+o.POS.POWERUPS.DELTA*t++,r=e.add.image(a-4,n-4,o.LEVEL.POWERUPS.SELECTED).setOrigin(0).setDepth(2).setVisible(!1),l=e.add.image(a,n,i.icon).setOrigin(0).setDepth(3),d=E[s].hasOwnProperty("requires"),u=e.add.image(a,n,o.LEVEL.POWERUPS.DISABLED).setOrigin(0).setDepth(4).setVisible(d);u.setInteractive(),e.visual.selected_powerups[s]=r,e.visual.disabled_powerups[s]=u,l.setInteractive(),l.on(o.MOUSE.CLICK_RELEASE,(()=>{e.GAMEPLAY.ACTIVE_POWERUPS.includes(s)?this.removePowerup(e,s):this.addPowerup(e,s),this.checkPowerups(e)}))}},removePowerup(e,t){d.arrayRemove(e.GAMEPLAY.ACTIVE_POWERUPS,t)&&(E[t].unapply(e),e.visual.selected_powerups[t].setVisible(!1))},addPowerup(e,t){if(e.GAMEPLAY.ACTIVE_POWERUPS.push(t),E[t].apply(e),e.visual.selected_powerups[t].setVisible(!0),E[t].hasOwnProperty("incompatible"))for(const s of E[t].incompatible)this.removePowerup(e,s)},checkPowerups(e){for(const t of e.GAMEPLAY.powerups.slice(0,4)){let s=!0;E[t].hasOwnProperty("requires")?(s=E[t].requires.every((t=>e.GAMEPLAY.ACTIVE_POWERUPS.includes(t))),e.visual.disabled_powerups[t].setVisible(!s)):e.visual.disabled_powerups[t].setVisible(!1),s||this.removePowerup(e,t)}},placeRouteBar(e){const t=e.add.image(o.POS.ROUTE.BAR[0],o.POS.ROUTE.BAR[1],o.LEVEL.ROUTE.BAR_FULL).setOrigin(0).setDepth(1);e.add.image(o.POS.ROUTE.BAR[0],o.POS.ROUTE.BAR[1],o.LEVEL.ROUTE.BAR_EMPTY).setOrigin(0).setDepth(0),t.displayWidth=32.5,e.visual.route_bar=t},advanceRouteBar(e,t,s){const i=32.5+90*(t+1),a=e.visual.route_bar;a.displayWidth=i-90;const n=e.GAMEPLAY.MAX_AUTONOMY/e.GAMEPLAY.AUTONOMY_MULTIPLIER,r=Math.min(1,s/n),l=e.visual.battery_full.displayWidth,E=e.visual.battery_ref,d=e.visual.battery_bar,u=r*E.displayWidth;e.tweens.add({targets:[a,d],displayWidth:function(e,t,s,o,a,n){switch(o){case 0:return i;case 1:return u;default:return 0}},duration:o.ANIM.DURATION,ease:Phaser.Math.Easing.Linear,onUpdate:t=>{const s=t.data[1].current/l;this.updateBatteryPercentage(e,s)},onComplete:()=>{e.return.index++,this.levelCheck(e)}})},resetRouteBar(e){e.visual.route_bar.displayWidth=0,e.visual.battery_bar.displayWidth=0,this.updateBatteryPercentage(e,0)},placeRouteSlot(e,t,s,i){if(t)e.visual.openRoutes.push(e.add.image(s,i,o.LEVEL.ROUTE.OPEN).setOrigin(0).setDepth(2)),t>1&&e.visual.closedRoutes.push(e.add.image(s,i,o.LEVEL.ROUTE.CLOSED).setOrigin(0).setDepth(3));else{let t=e.add.image(s,i,e.GAMEPLAY.routes[0].icon).setOrigin(0).setDepth(1);e.GAMEPLAY.routes[0].icon=t}},setupBatteryBar(e){const t=e.add.image(o.POS.BATTERY.BAR[0],o.POS.BATTERY.BAR[1],o.LEVEL.BATTERY.FULL).setOrigin(0).setDepth(1),s=e.add.image(o.POS.BATTERY.BAR[0],o.POS.BATTERY.BAR[1],o.LEVEL.BATTERY.USABLE).setOrigin(0).setDepth(2),i=e.add.image(o.POS.BATTERY.BAR[0],o.POS.BATTERY.BAR[1],o.LEVEL.BATTERY.USED).setOrigin(0).setDepth(2);e.visual.battery_full=t,s.displayWidth=t.frame.width*e.DATA.max_battery_dec,e.visual.battery_ref=s,i.displayWidth=0,e.visual.battery_bar=i,e.visual.battery_perc=e.add.text(o.POS.BATTERY.PERCENTAGE[0],o.POS.BATTERY.PERCENTAGE[1],"0%",o.STYLES.BATTERY_PERCENTAGE).setOrigin(.5).setDepth(3)},updateBatteryPercentage(e,t){t=Math.round(100*t),e.visual.battery_perc.setText(t+"%")},checkAndRemoveRoute(e,t){let s=t+1;if(void 0!==e.GAMEPLAY.routes[t]&&void 0===e.GAMEPLAY.routes[s]){let s=e.GAMEPLAY.routes[t],i=e.GAMEPLAY.destinations[s.name];s.icon.destroy(),i.uses++,p.updateDestDisplay(i),e.GAMEPLAY.routes.pop(),e.visual.closedRoutes[e.GAMEPLAY.next_route--].setVisible(!0),this.updateGMapsUrl(e);let o="Home"===e.GAMEPLAY.routes[--t].name&&e.GAMEPLAY.next_route>1;e.visual.goButton.setVisible(o)}},checkAndAddRoute(e,t){if(null!==e.GAMEPLAY.selected_route){if(void 0!==e.GAMEPLAY.routes[t])return;let s=e.GAMEPLAY.selected_route;if(s!==e.GAMEPLAY.routes[e.GAMEPLAY.next_route-1].name){e.GAMEPLAY.routes[e.GAMEPLAY.next_route]={name:s,icon:e.add.image(e.visual.openRoutes[e.GAMEPLAY.next_route].x,e.visual.openRoutes[e.GAMEPLAY.next_route].y,e.GAMEPLAY.destinations[e.GAMEPLAY.selected_route].route).setOrigin(0).setDepth(2),occupied:!0},e.visual.closedRoutes[++e.GAMEPLAY.next_route].setVisible(!1);let t=e.GAMEPLAY.destinations[s];t.uses--,p.updateDestDisplay(t),e.GAMEPLAY.selected_route=null,e.visual.dest_outline.setVisible(!1),e.visual.goButton.setVisible("Home"===s),this.updateGMapsUrl(e)}}},checkRouteTouchInput(e,t){void 0===e.GAMEPLAY.routes[t]||void 0!==e.GAMEPLAY.routes[t+1]?this.checkAndAddRoute(e,t):this.checkAndRemoveRoute(e,t)},setupRoutes(e){for(let t in e.visual.closedRoutes)t<1||(e.visual.openRoutes[t].setInteractive(),t>1&&e.visual.closedRoutes[t].setInteractive(),e.visual.openRoutes[t].on(o.MOUSE.CLICK_RELEASE,(s=>{let i=parseInt(t);s.wasTouch?this.checkRouteTouchInput(e,i):s.rightButtonReleased()?this.checkAndRemoveRoute(e,i):this.checkAndAddRoute(e,i)})))},setupGoButton(e){e.add.image(o.POS.GO[0],o.POS.GO[1],o.LEVEL.GO.UNUSABLE).setOrigin(0).setDepth(1);let t=e.add.image(o.POS.GO[0],o.POS.GO[1],o.LEVEL.GO.USABLE).setOrigin(0).setDepth(1);return t.setVisible(!1),t.setInteractive(),t.on(o.MOUSE.CLICK,(()=>{if(e.CLICKABLE){let t=this.getDirectionsUrl(e);e.scene.launch(o.SCENES.DEFER,{type:u.CHECK,data:e,url:t}),e.CLICKABLE=!1}})),t},processInitCall(e){const t=e.return;if("OK"!==t.status)return e.return=void 0,void delete e.return;const s=t.routes[0];let i=0;for(const e of s.legs)i+=e.distance.value;let a=1;if(e.hasOwnProperty("DESIRED_POWERUPS"))for(const t of e.DESIRED_POWERUPS)e.GAMEPLAY.powerups.includes(t)&&(a*=E[t].multiplier);let n=i*a,r=n/1e3/o.CALC.BASE;e.DATA.hasOwnProperty("calculated_autonomy")&&n<=e.DATA.calculated_autonomy&&(e.return=void 0,delete e.return),e.DATA.calculated_autonomy=n,r>1&&(d.arrayRemove(e.GAMEPLAY.powerups,"Power-Down"),d.arrayRemove(e.DESIRED_POWERUPS,"Power-Down")&&(a/=E["Power-Down"].multiplier,n=i*a,r=n/1e3/o.CALC.BASE)),e.DATA.hasOwnProperty("max_battery_dec")&&e.DATA.max_battery_dec,e.DATA.max_battery_dec=Math.min(1,r),e.MAX_AUTONOMY=1e3*o.CALC.BASE*e.DATA.max_battery_dec,e.DATA.max_battery=Math.round(100*e.DATA.max_battery_dec),e.return=void 0,delete e.return},processCheckCall(e){const t=e.return;if("OK"!==t.status)return e.return=void 0,void delete e.return;const s=t.routes[0].legs.map((e=>e.distance.value));e.return={route:s,distance:0,index:0},this.levelCheck(e)},levelCheck(e){if(void 0===e.return)return;const t=e.return,s=e.GAMEPLAY;if(s.MAX_AUTONOMY/s.AUTONOMY_MULTIPLIER-t.distance<=o.CALC.MARGIN){e.return=void 0;const s=r.LEVELS.hasOwnProperty(r.NEXT),i=s?d.copy(r.LEVELS[r.NEXT]):void 0;return void e.scene.launch(o.SCENES.MODAL_EOL,{maps:[e.visual.map_place,e.visual.map_directions],content:{level:{dist:t.distance},parent:e,hasNextLevel:s,next:i}})}if(0===t.route.length)return this.launchModal(e,{text:o.MODALS.LEVEL_FAILED,btn:o.MODALS.BTN_TRYAGAIN}),e.return=void 0,this.resetRouteBar(e),void(e.CLICKABLE=!0);const i=t.route.shift();t.distance+=i*s.DIST_MULTIPLIER,this.advanceRouteBar(e,t.index,t.distance)},launchModal(e,t){e.scene.launch(o.SCENES.MODAL,{maps:[e.visual.map_place,e.visual.map_directions],content:t})},getDirectionsUrl(e){let t=this.generateGMapsWaypoints(e.GAMEPLAY);if(!(t.length<2))return this.makeUrlFromWaypoints(t)},makeUrlFromWaypoints(e){let t=n.API_URL+"/get_directions"+"?mode=driving&units=metric"+("&origin="+e[0])+("&destination="+e[e.length-1]);if(t=t.replace("//","/"),e.length>2){t+="&waypoints="+e.slice(1,e.length-1).join("|")}return t},updateGMapsUrl(e){let t=e.visual.map_place,s=e.visual.map_directions,i=this.generateGMapsWaypoints(e.GAMEPLAY),o="https://www.google.com/maps/embed/v1/",a=i.length<2?"place":"directions",r="?key="+n.API_KEY;if(i.length<2){let e=o+a+r+("&q="+i[0]);t.src!==e&&(t.src=e),s.style.display="none",t.style.display="block"}else{let e="&mode=driving&units=metric"+("&origin="+i[0])+("&destination="+i[i.length-1]);if(i.length>2){e+="&waypoints="+i.slice(1,i.length-1).join("|")}let n=o+a+r+e;s.src!==n&&(s.src=n),t.style.display="none",s.style.display="block"}},generateGMapsWaypoints:e=>e.routes.map((t=>e.destinations[t.name].map_url))};class c extends Phaser.Scene{constructor(){super({key:o.SCENES.DEFER})}init(e){this.type=e.type,this.data=e.data,this.url=e.url}preload(){}create(){switch(this.type){case u.INIT:for(const[e,t]of Object.entries(this.url))for(const s of t)fetch(s).then((e=>e.json())).then((t=>{this.data[e].return=t,p.processInitCall(this.data[e])}));break;case u.CHECK:const e=document.getElementById("overlay");e.style.display="block";const t=setTimeout((()=>{e.style.display="none"}),3e3);fetch(this.url).then((e=>e.json())).then((t=>{this.data.return=t,e.style.display="none",p.processCheckCall(this.data)})),clearTimeout(t);break;default:console.log("Request type was not defined")}}}class O extends Phaser.Scene{constructor(){super({key:o.SCENES.LEVEL})}init(e){0==Object.keys(e).length&&console.error("No data was received from the loading scene"),this.DATA=e.DATA,this.GAMEPLAY=e.GAMEPLAY,this.GAMEPLAY.MAX_AUTONOMY=e.MAX_AUTONOMY,this.GAMEPLAY.DIST_MULTIPLIER=1,this.GAMEPLAY.AUTONOMY_MULTIPLIER=1,this.GAMEPLAY.ACTIVE_POWERUPS=[],this.CLICKABLE=!0,e.hasOwnProperty("script_key")&&(this.script=r.LEVELS[e.script_key].script)}preload(){this.visual={map_place:document.getElementById("gm-place"),map_directions:document.getElementById("gm-directions")},this.visual.map_place.style.display="block",p.updateGMapsUrl(this)}create(){this.visual.openRoutes=[null],this.visual.closedRoutes=[null,null],this.input.mouse.disableContextMenu(),p.setupInterface(this),p.placePowerUps(this);for(let e in this.GAMEPLAY.destinations)p.placeDestinationSquare(this,e);p.setupBatteryBar(this),p.placeRouteBar(this);for(let e=0;e<8;e++)p.placeRouteSlot(this,e,o.POS.ROUTE.SLOT[0]+e*o.POS.ROUTE.SLOT_GAP,o.POS.ROUTE.SLOT[1]);p.setupRoutes(this),this.visual.goButton=p.setupGoButton(this),void 0!==this.script&&(this.script(this),this.script=void 0)}}class h extends Phaser.Scene{constructor(){super({key:o.SCENES.LOAD})}init(){}preload(){this.load.setBaseURL(n.ASSETS_URL),this.load.image(o.TITLE.BACKGROUND,"title/bg.png"),this.load.image(o.TITLE.PLAY,"title/button_play.png"),this.load.image(o.TITLE.CREDITS,"title/button_credits.png"),this.load.image(o.TITLE.MINI,"title/mini.png"),this.load.image(o.CREDITS.TEXT,"credits/credits.png"),this.load.image(o.CREDITS.BUTTON,"credits/exit_button.png"),this.load.image(o.LEVEL.BACKGROUND,"level/bg.png"),this.load.image(o.ICONS.TEMPERATURE,"level/status_icons/temperature_icon.png"),this.load.image(o.ICONS.HUMIDITY,"level/status_icons/humidity_icon.png"),this.load.image(o.ICONS.BATTERY,"level/status_icons/battery_icon.png"),this.load.image(o.WEATHER.REGULAR.ICON,"level/status_icons/weather/regular.png"),this.load.image(o.WEATHER.CHILL.ICON,"level/status_icons/weather/rain.png"),this.load.image(o.WEATHER.COLD.ICON,"level/status_icons/weather/snow.png"),this.load.image(o.WEATHER.HOT.ICON,"level/status_icons/weather/sunny.png"),this.load.image(o.WEATHER.WARM.ICON,"level/status_icons/weather/warm.png"),this.load.image(o.LEVEL.POWERUPS.BAR,"level/powerups/bar.png"),this.load.image(o.LEVEL.POWERUPS.HOT,"level/powerups/hot.png"),this.load.image(o.LEVEL.POWERUPS.HEAT,"level/powerups/heating.png"),this.load.image(o.LEVEL.POWERUPS.COLD,"level/powerups/cold.png"),this.load.image(o.LEVEL.POWERUPS.COOL,"level/powerups/cooling.png"),this.load.image(o.LEVEL.POWERUPS.DOUBLETIME,"level/powerups/double-time.png"),this.load.image(o.LEVEL.POWERUPS.POWERDOWN,"level/powerups/power-down.png"),this.load.image(o.LEVEL.POWERUPS.SELECTED,"level/powerups/selected.png"),this.load.image(o.LEVEL.POWERUPS.DISABLED,"level/powerups/unusable.png"),this.load.image(o.DEST.SELECTED,"level/dest/selected.png"),this.load.image(o.DEST.HOME,"level/dest/home.png"),this.load.image(o.DEST.HOME_OUT,"level/dest/home_out.png"),this.load.image(o.DEST.WORK,"level/dest/work.png"),this.load.image(o.DEST.WORK_OUT,"level/dest/work_out.png"),this.load.image(o.DEST.SUPERMARKET,"level/dest/supermarket.png"),this.load.image(o.DEST.SUPERMARKET_OUT,"level/dest/supermarket_out.png"),this.load.image(o.DEST.GYM,"level/dest/gym.png"),this.load.image(o.DEST.GYM_OUT,"level/dest/gym_out.png"),this.load.image(o.LEVEL.ROUTE.OPEN,"level/routes/open.png"),this.load.image(o.LEVEL.ROUTE.CLOSED,"level/routes/closed.png"),this.load.image(o.LEVEL.ROUTE.BAR_EMPTY,"level/routes/bar_empty.png"),this.load.image(o.LEVEL.ROUTE.BAR_FULL,"level/routes/bar_full.png"),this.load.image(o.LEVEL.ROUTE.HOME,"level/routes/home.png"),this.load.image(o.LEVEL.ROUTE.WORK,"level/routes/work.png"),this.load.image(o.LEVEL.ROUTE.SUPERMARKET,"level/routes/supermarket.png"),this.load.image(o.LEVEL.ROUTE.GYM,"level/routes/gym.png"),this.load.image(o.LEVEL.BATTERY.FULL,"level/battery_full_bar.png"),this.load.image(o.LEVEL.BATTERY.USABLE,"level/battery_usable_bar.png"),this.load.image(o.LEVEL.BATTERY.USED,"level/battery_used_bar.png"),this.load.image(o.PLACEHOLDER.MAP,"level/mocks/map.png"),this.load.image(o.PLACEHOLDER.POWERUPS,"level/mocks/powerups.png"),this.load.image(o.LEVEL.GO.USABLE,"level/go_button.png"),this.load.image(o.LEVEL.GO.UNUSABLE,"level/go_unusable.png"),this.load.image(o.MODALS.BG,"modals/overlay-bg.png"),this.load.image(o.MODALS.INTRO,"modals/1_intro.png"),this.load.image(o.MODALS.TUTORIAL_1,"modals/2_tutorial_1-3.png"),this.load.image(o.MODALS.TUTORIAL_2,"modals/2_tutorial_2-3.png"),this.load.image(o.MODALS.TUTORIAL_3,"modals/2_tutorial_3-3.png"),this.load.image(o.MODALS.POWERUPS_1,"modals/3_powerups_1-3.png"),this.load.image(o.MODALS.POWERUPS_2,"modals/3_powerups_2-3.png"),this.load.image(o.MODALS.POWERUPS_3,"modals/3_powerups_3-3.png"),this.load.image(o.MODALS.NOMOREHELP,"modals/4_no-more-help.png"),this.load.image(o.MODALS.EOL,"modals/5_end-of-level.png"),this.load.image(o.MODALS.GAMEOVER_1,"modals/6_end-of-game_1-2.png"),this.load.image(o.MODALS.GAMEOVER_2,"modals/6_end-of-game_2-2.png"),this.load.image(o.MODALS.LEVEL_FAILED,"modals/7_level-failed.png"),this.load.image(o.MODALS.WAIT_LOAD,"modals/8_wait-load.png"),this.load.image(o.MODALS.NAV_L,"modals/button_left.png"),this.load.image(o.MODALS.NAV_R,"modals/button_right.png"),this.load.image(o.MODALS.BTN_INTRO,"modals/button_lets-go.png"),this.load.image(o.MODALS.BTN_TUTORIAL,"modals/button_got-it.png"),this.load.image(o.MODALS.BTN_POWERUPS,"modals/button_im-ready.png"),this.load.image(o.MODALS.BTN_NOMOREHELP,"modals/button_thumbs-up.png"),this.load.image(o.MODALS.BTN_EOL_BACK,"modals/button_level-repeat.png"),this.load.image(o.MODALS.BTN_EOL_ADVANCE,"modals/button_level-advance.png"),this.load.image(o.MODALS.BTN_MAINMENU,"modals/button_main-menu.png"),this.load.image(o.MODALS.BTN_TRYAGAIN,"modals/button_try-again.png"),this.load.image(o.MODALS.BTN_FINE,"modals/button_fine.png");const e={};for(const[t,s]of Object.entries(r.LEVELS)){e[t]=[];for(const i of s.DESIRED_ROUTES){const o=i.map((e=>s.GAMEPLAY.destinations[e].map_url));if(o.length<2)continue;const a=p.makeUrlFromWaypoints(o);e[t].push(a)}}this.scene.launch(o.SCENES.DEFER,{type:u.INIT,data:r.LEVELS,url:e})}create(){this.scene.start(o.SCENES.MENU)}}class A extends Phaser.Scene{constructor(){super({key:o.SCENES.MENU})}preload(){document.getElementById("gm-place").style.display="none";document.getElementById("gm-directions").style.display="none"}create(){this.add.image(0,0,o.TITLE.BACKGROUND).setOrigin(0).setDepth(0);let e=this.add.image(this.game.renderer.width/2,this.game.renderer.height/2,o.TITLE.PLAY).setDepth(2),t=this.add.image(this.game.renderer.width/2,this.game.renderer.height/2+100,o.TITLE.CREDITS).setDepth(2),s=this.add.image(100,100,o.TITLE.MINI).setScale(.75).setVisible(!1);e.setInteractive(),e.on(o.MOUSE.HOVER,(()=>{s.x=e.x-.8*e.width,s.y=e.y,s.setVisible(!0)})),e.on(o.MOUSE.LEAVE,(()=>{s.setVisible(!1)})),e.on(o.MOUSE.CLICK_RELEASE,(()=>{for(const e of Object.values(r.LEVELS))if(!e.hasOwnProperty("MAX_AUTONOMY"))return void this.scene.launch(o.SCENES.MODAL,{maps:[],content:{text:o.MODALS.WAIT_LOAD,btn:o.MODALS.BTN_FINE}});p.accumulated_distance=0,this.scene.launch(o.SCENES.MODAL_T,{content:{text:o.MODALS.INTRO,btn:o.MODALS.BTN_INTRO},next:o.SCENES.LEVEL,next_data:d.copy(r.LEVELS[r.NEXT++]),prev_scene:this.scene})})),t.setInteractive(),t.on(o.MOUSE.HOVER,(()=>{s.x=t.x-.8*t.width,s.y=t.y,s.setVisible(!0)})),t.on(o.MOUSE.LEAVE,(()=>{s.setVisible(!1)})),t.on(o.MOUSE.CLICK_RELEASE,(()=>{this.scene.launch(o.SCENES.CREDITS)}))}}class _ extends Phaser.Scene{constructor(){super({key:o.SCENES.MODAL_EOL})}init(e){0==Object.keys(e).length&&console.error("No data was received from the loading scene"),this.maps=e.maps.filter((e=>"block"===e.style.display)),this.page_content=e.content.level,this.parentScene=e.content.parent,this.hasNextLevel=e.content.hasNextLevel,this.nextScene=e.content.next}preload(){}create(){for(const e of this.maps)e.style.display="none";this.add.image(0,0,o.MODALS.BG).setOrigin(0).setDepth(0).setInteractive(),this.add.image(53,45,o.MODALS.EOL).setOrigin(0).setDepth(1);const e=d.roundToDecimals(this.page_content.dist/1e3,1),t=d.roundToDecimals(o.CALC.PREDICTED_DIST_TO_EMISSIONS*e,0),s=d.roundToDecimals(o.CALC.PREDICTED_DIST_TO_FUEL*e,2),i=d.roundToDecimals(o.CALC.PREDICTED_FUEL_TO_MONEY*s,2);this.add.text(154,169,`Traveled ${e} kilometers`,o.STYLES.END_OF_LEVEL).setOrigin(0).setDepth(2),this.add.text(154,225,`Saved ${t} grams of CO2 emissions`,o.STYLES.END_OF_LEVEL).setOrigin(0).setDepth(2),this.add.text(154,281,`Saved ${s} liters of fuel, saving around ${i}€`,o.STYLES.END_OF_LEVEL).setOrigin(0).setDepth(2);const a=this.add.image(149,428,o.MODALS.BTN_EOL_BACK).setOrigin(0).setDepth(2),n=this.add.image(451,428,o.MODALS.BTN_EOL_ADVANCE).setOrigin(0).setDepth(2);a.setInteractive(),a.on(o.MOUSE.CLICK_RELEASE,(()=>{p.resetRouteBar(this.parentScene);for(const e of this.maps)e.style.display="block";this.parentScene.CLICKABLE=!0,this.scene.stop()})),n.setInteractive(),n.on(o.MOUSE.CLICK_RELEASE,(()=>{this.parentScene.scene.stop(),p.accumulated_distance+=this.page_content.dist,this.hasNextLevel?(r.NEXT++,this.scene.start(o.SCENES.LEVEL,this.nextScene)):(r.NEXT=1,this.scene.start(o.SCENES.MODAL_GAMEOVER))}))}}class L extends Phaser.Scene{constructor(){super({key:o.SCENES.MODAL_GAMEOVER})}preload(){}create(){this.add.image(0,0,o.TITLE.BACKGROUND).setOrigin(0).setDepth(0);this.add.image(0,0,o.MODALS.BG).setOrigin(0).setDepth(1).setInteractive();const e=p.accumulated_distance,t=d.roundToDecimals(e/1e3,1),s=d.roundToDecimals(o.CALC.PREDICTED_DIST_TO_EMISSIONS*t,0),i=d.roundToDecimals(o.CALC.PREDICTED_DIST_TO_FUEL*t,2),a=d.roundToDecimals(o.CALC.PREDICTED_FUEL_TO_MONEY*i,2),n=this.add.image(58,50,o.MODALS.GAMEOVER_1).setOrigin(0).setDepth(2),r=this.add.text(171,272,`Traveled ${t} kilometers`,o.STYLES.END_OF_LEVEL).setOrigin(0).setDepth(3),l=this.add.text(171,328,`Saved ${s} grams of CO2 emissions`,o.STYLES.END_OF_LEVEL).setOrigin(0).setDepth(3),E=this.add.text(171,384,`Saved ${i} liters of fuel, saving around ${a}€`,o.STYLES.END_OF_LEVEL).setOrigin(0).setDepth(3),u=this.add.image(703.25,280.95,o.MODALS.NAV_R).setOrigin(0).setDepth(3),c=[n,r,l,E,u],O=this.add.image(58,50,o.MODALS.GAMEOVER_2).setOrigin(0).setDepth(2).setVisible(!1),h=this.add.image(79,280.95,o.MODALS.NAV_L).setOrigin(0).setDepth(3).setVisible(!1),A=this.add.image(302.64,450,o.MODALS.BTN_MAINMENU).setOrigin(0).setDepth(3).setVisible(!1),_=[O,h,A];h.setInteractive(),h.on(o.MOUSE.CLICK_RELEASE,(()=>{for(const e of c)e.setVisible(!0);for(const e of _)e.setVisible(!1)})),u.setInteractive(),u.on(o.MOUSE.CLICK_RELEASE,(()=>{for(const e of c)e.setVisible(!1);for(const e of _)e.setVisible(!0)})),A.setInteractive(),A.on(o.MOUSE.CLICK_RELEASE,(()=>{this.scene.start(o.SCENES.LOAD)}))}}class T extends Phaser.Scene{constructor(){super({key:o.SCENES.MODAL})}init(e){0==Object.keys(e).length&&console.error("No data was received from the loading scene"),this.maps=e.maps.filter((e=>"block"===e.style.display)),Array.isArray(e.content.text)||(e.content.text=[e.content.text]),this.page_content=e.content.text,this.max_page=this.page_content.length-1,this.button=e.content.btn,this.pages=[],this.page_number=0}preload(){}create(){for(const e of this.maps)e.style.display="none";this.add.image(0,0,o.MODALS.BG).setOrigin(0).setDepth(0).setInteractive();for(const[e,t]of this.page_content.entries())this.pages.push(this.add.image(53,45,t).setOrigin(0).setDepth(1).setVisible(0==e));const e=this.max_page>0,t=this.add.image(79,280.95,o.MODALS.NAV_L).setOrigin(0).setDepth(2).setVisible(!1),s=this.add.image(703.25,280.95,o.MODALS.NAV_R).setOrigin(0).setDepth(2).setVisible(e),i=this.add.image(0===this.max_page?302.64:511,450,this.button).setOrigin(0).setDepth(2).setVisible(!e);t.setInteractive(),t.on(o.MOUSE.CLICK_RELEASE,(()=>{this.pages[this.page_number--].setVisible(!1),this.pages[this.page_number].setVisible(!0),s.setVisible(!0),t.setVisible(this.page_number>0),i.setVisible(this.page_number===this.max_page)})),s.setInteractive(),s.on(o.MOUSE.CLICK_RELEASE,(()=>{this.pages[this.page_number++].setVisible(!1),this.pages[this.page_number].setVisible(!0),t.setVisible(!0),s.setVisible(this.page_number<this.max_page),i.setVisible(this.page_number===this.max_page)})),i.setInteractive(),i.on(o.MOUSE.CLICK_RELEASE,(()=>{for(const e of this.maps)e.style.display="block";this.scene.stop()}))}}class m extends Phaser.Scene{constructor(){super({key:o.SCENES.MODAL_T})}init(e){0==Object.keys(e).length&&console.error("No data was received from the loading scene"),this.next=e.next,this.next_data=e.next_data,this.prev_scene=e.prev_scene,e.hasOwnProperty("maps")?this.maps=e.maps.filter((e=>"block"===e.style.display)):this.maps=[],Array.isArray(e.content.text)||(e.content.text=[e.content.text]),this.page_content=e.content.text,this.max_page=this.page_content.length-1,this.button=e.content.btn,this.pages=[],this.page_number=0}preload(){}create(){for(const e of this.maps)e.style.display="none";this.add.image(0,0,o.MODALS.BG).setOrigin(0).setDepth(0).setInteractive();for(const[e,t]of this.page_content.entries())this.pages.push(this.add.image(53,45,t).setOrigin(0).setDepth(1).setVisible(0==e));const e=this.max_page>0,t=this.add.image(79,280.95,o.MODALS.NAV_L).setOrigin(0).setDepth(2).setVisible(!1),s=this.add.image(703.25,280.95,o.MODALS.NAV_R).setOrigin(0).setDepth(2).setVisible(e),i=this.add.image(0===this.max_page?302.64:511,450,this.button).setOrigin(0).setDepth(2).setVisible(!e);t.setInteractive(),t.on(o.MOUSE.CLICK_RELEASE,(()=>{this.pages[this.page_number--].setVisible(!1),this.pages[this.page_number].setVisible(!0),s.setVisible(!0),t.setVisible(this.page_number>0),i.setVisible(this.page_number===this.max_page)})),s.setInteractive(),s.on(o.MOUSE.CLICK_RELEASE,(()=>{this.pages[this.page_number++].setVisible(!1),this.pages[this.page_number].setVisible(!0),t.setVisible(!0),s.setVisible(this.page_number<this.max_page),i.setVisible(this.page_number===this.max_page)})),i.setInteractive(),i.on(o.MOUSE.CLICK_RELEASE,(()=>{for(const e of this.maps)e.style.display="block";this.prev_scene.stop(),this.scene.start(this.next,this.next_data)}))}}new Phaser.Game({width:800,height:600,scene:[h,A,O,c,a,T,m,_,L]});d.reposition(),window.addEventListener("resize",d.reposition);
//# sourceMappingURL=game.bdd3c54a.js.map
